# üïµÔ∏è‚Äç‚ôÇÔ∏è IDOR ‚Äî Insecure Direct Object Reference  
*TryHackMe | Jr. Web Penetration Tester Learning Path*  
*Room URL: https://tryhackme.com/room/idor*
![image](https://github.com/user-attachments/assets/e23681c8-57f2-4371-8ee1-1528fdb3e818)

---

## üéØ Objective

- Understand and exploit Insecure Direct Object Reference (IDOR) vulnerabilities in web applications.
- Gain hands-on experience manipulating object references in URLs or parameters.

---

## üìã Setup

1. Login to TryHackMe and deploy the **IDOR** room.
2. Ensure VPN connection or port-forwarding is active.
3. Confirm target machine IP (e.g. `10.10.0.123`).

```bash
# Connect via OpenVPN
sudo openvpn <your-credential-file>.ovpn
```

## Task 1: What is an IDOR?

**Q:** What does **IDOR** stand for?  
**A:** *Insecure Direct Object Reference*

---

### üîç Definition:
IDOR is a type of access control vulnerability that occurs when an application exposes a reference to an internal object‚Äîsuch as a file, database record, or user ID‚Äî**without proper authorization checks**.

---

### ‚úÖ Example:
```http
GET /profile?user_id=1002
```

## Task 2: An IDOR Example

In this example, we analyzed a simulated email client and identified a URL that may be vulnerable to an Insecure Direct Object Reference (IDOR).

---

### üì® Email Discovery

We found the following invoice link in an order confirmation email:  https://onlinestore.thm/order/1234/invoice



<img src="https://github.com/Nisha318/Nisha318.github.io/blob/master/assets/images/thm/idor/idor-02.PNG">



By modifying the order number from `1234` to `1000`, we were able to access another user's invoice, which confirms an IDOR vulnerability.

---

### üîç Exploitation Result

Modified URL:  https://onlinestore.thm/order/1000/invoice

<img src="https://github.com/Nisha318/Nisha318.github.io/blob/master/assets/images/thm/idor/idor-03.PNG">


This exposed sensitive information for another user (name, address, and order).

---

### üèÅ Flag

THM{IDOR-VULN-FOUND}


---

## Task 3: Finding IDORs in Encoded IDs

Sometimes object references in URLs or parameters are not shown as plain numbers but are encoded to appear less obvious. However, this does **not** equal security if access control checks are missing.

---

**Q:** What is a common type of encoding used by websites?  
**A:** `base64`

---


## Task 4: Finding IDORs in Hashed IDs

Some applications try to obscure object references by using **hashed IDs** instead of plain or encoded values. While this may make enumeration harder, it is still **not a substitute for proper access control**.

---

**Q:** What is a common algorithm used for hashing IDs?  
**A:** `md5`

---

## Task 5: Finding IDORs in Unpredictable IDs

Some applications attempt to protect against IDOR by using **unpredictable or random-looking IDs**, such as UUIDs, GUIDs, or long alphanumeric strings.

While this can deter basic enumeration, it still **does not prevent IDOR** if proper access control is not in place.

---

**Q:** What is the minimum number of accounts you need to create to check for IDORs between accounts?  
**A:** `2`

---

## Task 6: Where are IDORs Located?

IDOR vulnerabilities can appear **anywhere user input is used to reference objects**, especially if the application doesn't validate whether the user is authorized to access the resource.

---

## Task 7: A Practical IDOR Example

In this task, we observed a real-world style API endpoint returning user data based on a `customer?id=1` query parameter. This demonstrates how an IDOR vulnerability can exist if the application fails to validate ownership of the requested resource.

---

### üîç Observation

Using browser dev tools (Network tab), we accessed:  GET http://10.10.99.57/api/v1/customer?id=1


The server responded with user information in JSON format:

```json
{
  "id": 1,
  "username": "adam84",
  "email": "adam-84@fakemail.thm"
}
```

<img src="https://github.com/Nisha318/Nisha318.github.io/blob/master/assets/images/thm/idor/idor-04.PNG">

Q: What is the username for user ID 1?
A: adam84



### üîç Request Example

GET http://10.10.99.57/api/v1/customer?id=3


```json
{
  "id": 3,
  "username": "john911",
  "email": "j@fakemail.thm"
}
```
Q: What is the email address for user ID 3?
A: j@fakemail.thm

<img src="https://github.com/Nisha318/Nisha318.github.io/blob/master/assets/images/thm/idor/idor-05.PNG">
